<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>[(${BlogSelected.title})]</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description"
          th:content="${BlogSelected.description}">
    <meta name="keywords" content="HTML,CSS,XML,JavaScript">
    <meta name="author" content="Đoàn Đức Tín">
    <meta property="og:image"
          th:content="${BlogSelected.image}"/>
    <th:block th:insert="Common/_css :: content"/>
    
    <!-- Custom -->
    <link rel="stylesheet" th:href="@{/Resource/blogsite/style.css}">
    <link rel="stylesheet" th:href="@{/Resource/codesnnipets/prism.css}">
    <style>
        .single-blog-post:hover{
            box-shadow: 0 1px 5px rgba(0, 0, 0, .6);
        }
        .rate {
            float: left;
            height: 46px;
            padding: 0 10px;
        }
        .rate:not(:checked) > input {
            position:absolute;
            top:-9999px;
        }
        .rate:not(:checked) > label {
            float:right;
            width:1em;
            overflow:hidden;
            white-space:nowrap;
            cursor:pointer;
            font-size:30px;
            color:#ccc;
        }
        .rate:not(:checked) > label:before {
            content: '★ ';
        }
        .rate > input:checked ~ label {
            color: #ffc700;
        }
        .rate:not(:checked) > label:hover,
        .rate:not(:checked) > label:hover ~ label {
            color: #deb217;
        }
        .rate > input:checked + label:hover,
        .rate > input:checked + label:hover ~ label,
        .rate > input:checked ~ label:hover,
        .rate > input:checked ~ label:hover ~ label,
        .rate > label:hover ~ input:checked ~ label {
            color: #c59b08;
        }

        /* Modified from: https://github.com/mukulkant/Star-rating-using-pure-css */

        .ftco-navbar-light{
            position: absolute;
            background-color: transparent !important;
        }
        .fa-angle-left{
            margin-left: 12px;
            padding: 0;
            text-align: left;
        }
        .fa-angle-right{
            margin-left: 12px;
            padding: 0;
            text-align: left;
        }
        .fa-angle-up{
            padding: 0;
            margin: 0;
        }
    </style>

</head>
<body>

<th:block th:insert="Common/header :: content"/>
<th:block th:insert="Common/topcontent_blog :: content"/>

<div class="main-content-wrapper section-padding-100">
    <div class="container-fluid">
        <div class="row justify-content-center">

            <!--CONTENT BLOG-->
            <div class="col-12 col-lg-9">
                <div class="single-blog-content mb-100">

                    <div class="row post-meta" style="padding-bottom: 8px">
                        <img width="35px" height="35px" style="border-radius: 50px;margin-left: 35px" th:src="${BlogSelected.userByUser.uAvatar}"/>
                        <p style="font-weight: 700">&nbsp;&nbsp;
                            <a th:href="'/profile/'+${BlogSelected.userByUser.uName}" class="post-author">[(${BlogSelected.userByUser.uName})]</a> vào
                            <a href="#" class="post-date">[(${BlogSelected.datepublic})]</a>
                        </p>
                    </div>

                    <div class="post-content">

                        <h1 style="font-family:'Work Sans','sans-serif'">[(${BlogSelected.title})]</h1>
                        <blockquote class="mb-30" style="border-color:darkorange">
                            <h6 style="font-family:'Work Sans','sans-serif'">[(${BlogSelected.description})]</h6>
                        </blockquote>
                        <div class="row justify-content-center">
                            <img style="max-height: 500px" th:src="${BlogSelected.image}"/>
                        </div>

                    </div>

                    <div class="post-content">
                        [(${BlogSelected.text})]
                    </div>

                    <div class="post-content">

                        <ul class="post-tags">
                            <li><a style="font-weight: 700;color: darkorange" th:href="'/blog/all?keyword='+${BlogSelected.category}">[(${BlogSelected.category})]</a></li>
                            <th:block th:each="i: ${BlogSelected.tagsList}">
                                <li><a style="font-weight: 700" th:href="'/blog/all?keyword='+${i}">[(${i})]</a></li>
                            </th:block>
                        </ul>
                        <hr>
                        <div class="row justify-content-center">
                            <div class="col-8">
                                <div class="row">
                                    <p id="rate-number" style="font-weight: 700;text-align: center;margin: 13px">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd" d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.523-3.356c.329-.314.158-.888-.283-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767l-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288l1.847-3.658 1.846 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.564.564 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z"></path>
                                        </svg>&nbsp;&nbsp;RATE: [(${BlogSelected.ratedPoint})]&nbsp;
                                    </p>
                                    <div class="progress custom-progress-success" style="margin: 16px;width: 50%">
                                        <div id="rate-bar" class="progress-bar bg-warning" role="progressbar" th:style="|color:darkorange;width: ${(BlogSelected.rate/BlogSelected.joinRate)*20}%|" aria-valuenow="72" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <p style="font-weight: 700;margin: 13px">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
                                            <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"></path>
                                            <path fill-rule="evenodd" d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"></path>
                                        </svg>&nbsp;&nbsp;[(${BlogSelected.view})]&nbsp;VIEW
                                    </p>
                                </div>
                            </div>
                            <div class="col-4">
                                    <form id="rate-form">
                                        <input type="hidden" name="blog" th:value="${BlogSelected.id}">
                                        <div class="rate">
                                            <input onclick="addRateAPI()" type="radio" id="star5" name="rate" value="5" />
                                            <label for="star5" title="Bài viết này rất hay">5 stars</label>
                                            <input onclick="addRateAPI()" type="radio" id="star4" name="rate" value="4" />
                                            <label for="star4" title="Bài viết tốt">4 stars</label>
                                            <input onclick="addRateAPI()" type="radio" id="star3" name="rate" value="3" />
                                            <label for="star3" title="Bài viết tạm">3 stars</label>
                                            <input onclick="addRateAPI()" type="radio" id="star2" name="rate" value="2" />
                                            <label for="star2" title="Bài viết chưa hay">2 stars</label>
                                            <input onclick="addRateAPI()" type="radio" id="star1" name="rate" value="1" />
                                            <label for="star1" title="Bài viết này quá tệ">1 star</label>
                                        </div>
                                    </form>
                                <span id="error-hadrated" style="text-align:center;color: red;font-weight: 700;font-size: 12px;display: none">Bạn đã đánh giá bài viết này rồi, thử lại sau nhé !</span>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

            <!--ASIDE-->
            <div class="col-12 col-md-6 col-lg-3">
                <div class="post-sidebar-area mb-100">

                    <!--ABOUT AUTHOR-->
                    <div class="sidebar-widget-area">
                        <h5 class="title">Giới thiệu tác giả</h5>
                        <div class="widget-content" style="width: 100%">
                            <div class="row justify-content-center">
                                <img style="width: 100px;max-height: 200px;border: 3px solid wheat;border-radius: 3px" th:src="${BlogSelected.userByUser.uAvatar}"/>
                            </div>
                            <br>
                            <a th:href="'/profile/'+${BlogSelected.userByUser.uName}" style="text-align: center">
                                <p>[(${BlogSelected.userByUser.uName})]&nbsp;@&nbsp;
                                    <b style="font-weight: 700;color:darkorange;font-family: Arial, Baskerville, monospace">
                                        [(${BlogSelected.userByUser.uDigitalName})]
                                    </b>
                                </p>
                            </a>

                            <hr>
                            <p style="font-weight: 700">[(${BlogSelected.userByUser.uCmtTitle})]</p>
                            <p>[(${BlogSelected.userByUser.uCmtDescrip})]</p>
                        </div>
                    </div>

                    <!--FUNCTION-->
                    <div class="sidebar-widget-area">
                        <h5 class="title">Thao tác</h5>
                        <div class="widget-content" style="width: 100%">
                            <a href="/blog"><button class="btn btn-success" style="border:0;background: linear-gradient(to right, #009fff, #ec2f4b);font-size: 12px;font-weight: 700;margin-bottom: 3px">TRENDING BLOGS</button></a>
                            <hr>
                            <a href="/blog/new"><button class="btn btn-outline-primary" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Viết bài (*)</button></a>

                            <!--BUTTON MANAGER BLOGS and EDIT POSTED BLOG-->
                            <th:block th:if="${session.user != null}">
                                <th:block th:if="${session.user.id != 4}">
                                    <a th:href="'/blog/manager/'+${session.user.uName}" ><button class="btn btn-outline-primary" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Quản lý bài</button></a>
                                    <th:block th:if="${session.user.id == BlogSelected.userByUser.getId()}">
                                        <a><button onclick="infoEdit()" class="btn btn-outline-warning" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Sửa bài viết</button></a>
                                    </th:block>
                                    <th:block th:if="${session.user.id != BlogSelected.userByUser.getId()}">
                                        <a><button class="btn btn-secondary disabled" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Sửa bài viết</button></a>
                                    </th:block>
                                </th:block>
                                <th:block th:if="${session.user.id == 4}">
                                    <a><button class="btn btn-secondary disabled" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Quản lý bài</button></a>
                                    <a><button class="btn btn-secondary disabled" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Sửa bài viết</button></a>
                                </th:block>
                            </th:block>
                            <th:block th:if="${session.user == null}">
                                <a><button class="btn btn-secondary disabled" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Quản lý bài</button></a>
                                <a><button class="btn btn-secondary disabled" style="font-size: 12px;font-weight: 700;margin-bottom: 3px">Sửa bài viết</button></a>
                            </th:block>

                        </div>
                    </div>

                    <!--PAGE-->
                    <div class="sidebar-widget-area">
                        <div class="sidebar-widget-area" style="text-align: center">
                            <div class="fb-page" data-href="https://www.facebook.com/satellitedevelop/" data-tabs="timeline" data-width="400px" data-height="" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/satellitedevelop/" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/satellitedevelop/">FStatic Community</a></blockquote></div>
                        </div>
                        <br>
                    </div>

                    <!--POST BY THIS AUTHOR-->
                    <div class="sidebar-widget-area">
                        <h5 class="title">Bài viết cùng tác giả</h5>
                        <div class="widget-content">

                            <th:block th:each="i: ${CurrentAuthorBlogList}">
                                <div th:onclick="goto('/blog/[(${i.name})]')" class="single-blog-post post-style-2 d-flex align-items-center widget-post" style="height: 80px">

                                    <div class="post-thumbnail">
                                        <img th:src="${i.image}" alt="" style="max-height: 80px;">
                                    </div>

                                    <div class="post-content">
                                        <a href="#" class="headline">
                                            <h5 class="mb-0" style="font-family:'Work Sans','sans-serif'">[(${i.title})]</h5>
                                        </a>
                                    </div>
                                </div>
                            </th:block>

                        </div>
                    </div>

                </div>
            </div>

        </div>

        <!--OTHER RELATION POSTS-->
        <div class="row">

            <th:block th:each="i: ${RelationBlogList}">
                <div class="col-12 col-md-6 col-lg-4">
                <div th:onclick="goto('/blog/[(${i.name})]')" class="single-blog-post">

                    <div class="post-thumbnail">
                        <img th:src="${i.image}" alt="" style="height: 240px">

                        <div class="post-cta"><a href="#" style="background-color: darkorange;color: white;font-weight: 700;font-family:'Work Sans','sans-serif'">BÀI VIẾT LIÊN QUAN</a></div>
                    </div>

                    <div class="post-content" style="height: 240px">
                        <a href="#" class="headline">
                            <h5 style="font-family:'Work Sans','sans-serif'">[(${i.title})]</h5>
                        </a>
                        <p style="overflow-y:scroll;height:100px ">[(${i.description})]</p>

                        <div class="post-meta">
                            <p><a href="#" class="post-author">[(${i.userByUser.uName})]</a> on <a href="#" class="post-date">[(${i.datepublic})]</a></p>
                        </div>
                    </div>
                </div>
            </div>
            </th:block>

        </div>

    </div>
</div>

<th:block th:insert="Common/_js :: content"/>
<th:block th:insert="Common/footer :: content"/>

<!-- Custom -->
<script th:src="@{/Resource/blogsite/js/jquery/jquery-2.2.4.min.js}"></script>
<script th:src="@{/Resource/blogsite/js/popper.min.js}"></script>
<script th:src="@{/Resource/blogsite/js/bootstrap.min.js}"></script>
<script th:src="@{/Resource/blogsite/js/plugins.js}"></script>
<script th:src="@{/Resource/blogsite/js/active.js}"></script>
<script th:src="@{/Resource/codesnnipets/prism.js}"></script>
<script th:src="@{/Resource/friendlydate/moment.js}"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-23581568-13');
    document.getElementById('drop-fpt-all').addEventListener('click',()=>{
        x=document.getElementById('header-dropdown-menu');
        y=document.getElementById('header-dropdown-content');
        if (x.classList.contains('show')){
            x.classList.remove('show');
            y.classList.remove('show');
        }else{
            x.classList.add('show');
            y.classList.add('show');
        }
    })
    x=document.getElementById('drop-btn-login');
    if (x!==null) x.addEventListener('click',()=>{
        if (document.getElementById('drop-menu-login').classList.contains('show')){
            document.getElementById('drop-menu-login').classList.remove('show');
        }else{
            document.getElementById('drop-menu-login').classList.add('show');
        }
    })
    document.querySelector('.owl-stage-outer').style.height='260px';
    document.querySelectorAll('.post-date').forEach((el)=>{
        el.innerText=moment(el.innerText,"YYYY-MM-DD hh:mm:ss").fromNow()
    });
    document.getElementById('scrollUp').style.left='30px';
</script>

<!-- Function -->
<script>
    function goto(x){
        window.location=x;
    }
    function disableScroll() {
        // Get the current page scroll position
        scrollTop =
            window.pageYOffset || document.documentElement.scrollTop;
        scrollLeft =
            window.pageXOffset || document.documentElement.scrollLeft,

            // if any scroll is attempted,
            // set this to the previous value
            window.onscroll = function() {
                window.scrollTo(scrollLeft, scrollTop);
            };
    }
    function enableScroll() {
        window.onscroll = function() {};
    }
    function addRateAPI() {
        disableScroll();
        var formData = new FormData(document.getElementById("rate-form"));
        $.ajax({
            type: 'POST',
            url: '/blog/api/rate',
            contentType: false,
            processData: false,
            //contentType: 'application/json',
            data: formData
        }).done(function (result) {
            enableScroll();
            if (result.toString().substring(0, 7) === "//ERROR") {
                document.getElementById('error-hadrated').style.display='inherit';
            } else {
                tmp=result.toString().split('|');
                document.getElementById('rate-number').innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star" viewBox="0 0 16 16">\n' +
                    '                                            <path fill-rule="evenodd" d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.523-3.356c.329-.314.158-.888-.283-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767l-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288l1.847-3.658 1.846 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.564.564 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z"></path>\n' +
                    '                                        </svg>&nbsp;&nbsp;RATE: ' + tmp[1] + '&nbsp;';
                document.getElementById('rate-bar').style.width = parseFloat(tmp[1]) * 20 + '%';
            }
        });
    }
    function infoEdit(){
        Swal.fire({
            width:700,
            title: 'Thận trọng khi sửa bài, hệ thống sẽ xử lí bài viết như sau',
            html: "<div style=\"overflow-y: scroll;display: block;height: 300px;text-align: left;\">" +
                "<li style='font-family: Arial, Baskerville, monospace'> Hành động sửa bài viết ĐÃ ĐƯỢC DUYỆT được tính như là đăng một bài mới với nội dung cũ, lượt xem, lượt đánh giá và một số thông tin sẽ được chuyển sang bài mới</li>" +
                "<li style='font-family: Arial, Baskerville, monospace'> Bài viết bạn sửa có thể không được duyệt, lúc đó bài viết cũ của bạn sẽ không bị ảnh hưởng. Trường hợp hệ thống duyệt bài viết bạn đã sửa, bài viết cũ sẽ bị ngưng kích hoạt</li>" +
                "<li style='font-family: Arial, Baskerville, monospace'> Bạn nên cân nhắc thực hiện hành động này, nếu nội dung cần sửa không nhiều, bạn có thể liên hệ với người kiểm duyệt để thay đổi</li>"+
                "<li style='font-family: Arial, Baskerville, monospace'> Cách xử lý như vậy nhằm tránh trường hợp đăng blog sau đó sửa thành nội dung khác kém chất lượng hơn, khiến cho tổng thể nội dung trên trang bị mất giá trị</li>",
            icon: 'warning',
            showCancelButton: true,
            showConfirmButton:true,
            confirmButtonText: 'Tiếp tục sửa',
            allowClickOutside:false,
            allowOutsideClick:false
        }).then((result) => {
            if (result.isConfirmed) {
                window.location="${pageContext.request.contextPath}/draftblog/${requestScope.blogSelected.name}"
            }
        })
    }
</script>

<!-- FireWorks -->
<canvas id="canvas" style="top: 1500px;position: absolute">Canvas is not supported in your browser.</canvas>
<th:block th:insert="Common/FireWorks/js :: content"/>

</body>
</html>